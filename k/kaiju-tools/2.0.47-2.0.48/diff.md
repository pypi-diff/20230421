# Comparing `tmp/kaiju_tools-2.0.47-py3-none-any.whl.zip` & `tmp/kaiju_tools-2.0.48-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,113 +1,113 @@
-Zip file size: 128060 bytes, number of entries: 111
--rw-r--r--  2.0 unx     3424 b- defN 23-Apr-19 12:08 kaiju_tools/CLI.py
--rw-r--r--  2.0 unx      272 b- defN 23-Apr-19 12:08 kaiju_tools/__init__.py
--rw-r--r--  2.0 unx     7473 b- defN 23-Apr-19 12:08 kaiju_tools/class_registry.py
--rw-r--r--  2.0 unx     6013 b- defN 23-Apr-19 12:08 kaiju_tools/exceptions.py
--rw-r--r--  2.0 unx      997 b- defN 23-Apr-19 12:08 kaiju_tools/fixtures.py
--rw-r--r--  2.0 unx     8965 b- defN 23-Apr-19 12:08 kaiju_tools/functions.py
--rw-r--r--  2.0 unx     2172 b- defN 23-Apr-19 12:08 kaiju_tools/init_app.py
--rw-r--r--  2.0 unx    18691 b- defN 23-Apr-19 12:08 kaiju_tools/jsonschema.py
--rw-r--r--  2.0 unx      195 b- defN 23-Apr-19 12:08 kaiju_tools/loop.py
--rw-r--r--  2.0 unx    13521 b- defN 23-Apr-19 12:08 kaiju_tools/mapping.py
--rw-r--r--  2.0 unx      159 b- defN 23-Apr-19 12:08 kaiju_tools/serialization.py
--rw-r--r--  2.0 unx     8221 b- defN 23-Apr-19 12:08 kaiju_tools/services.py
--rw-r--r--  2.0 unx    14345 b- defN 23-Apr-19 12:08 kaiju_tools/templates.py
--rw-r--r--  2.0 unx     4793 b- defN 23-Apr-19 12:08 kaiju_tools/ttl_dict.py
--rw-r--r--  2.0 unx     3691 b- defN 23-Apr-19 12:08 kaiju_tools/types.py
--rw-r--r--  2.0 unx     2595 b- defN 23-Apr-19 12:08 kaiju_tools/cache/__init__.py
--rw-r--r--  2.0 unx    11339 b- defN 23-Apr-19 12:08 kaiju_tools/cache/abc.py
--rw-r--r--  2.0 unx     2373 b- defN 23-Apr-19 12:08 kaiju_tools/cache/local_cache.py
--rw-r--r--  2.0 unx       43 b- defN 23-Apr-19 12:08 kaiju_tools/cache/services.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/cache/tests/__init__.py
--rw-r--r--  2.0 unx     2315 b- defN 23-Apr-19 12:08 kaiju_tools/cache/tests/test_cache.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/commands/__init__.py
--rw-r--r--  2.0 unx      932 b- defN 23-Apr-19 12:08 kaiju_tools/config/__init__.py
--rw-r--r--  2.0 unx     7661 b- defN 23-Apr-19 12:08 kaiju_tools/config/config_loader.py
--rw-r--r--  2.0 unx     2975 b- defN 23-Apr-19 12:08 kaiju_tools/config/configurator.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/config/tests/__init__.py
--rw-r--r--  2.0 unx      586 b- defN 23-Apr-19 12:08 kaiju_tools/config/tests/test_configurator.py
--rw-r--r--  2.0 unx      276 b- defN 23-Apr-19 12:08 kaiju_tools/docker/__init__.py
--rw-r--r--  2.0 unx     9554 b- defN 23-Apr-19 12:08 kaiju_tools/docker/containers.py
--rw-r--r--  2.0 unx     7830 b- defN 23-Apr-19 12:08 kaiju_tools/docker/images.py
--rw-r--r--  2.0 unx      103 b- defN 23-Apr-19 12:08 kaiju_tools/docker/services.py
--rw-r--r--  2.0 unx    11140 b- defN 23-Apr-19 12:08 kaiju_tools/docker/stack.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/docker/tests/__init__.py
--rw-r--r--  2.0 unx     1625 b- defN 23-Apr-19 12:08 kaiju_tools/docker/tests/fixtures.py
--rw-r--r--  2.0 unx      575 b- defN 23-Apr-19 12:08 kaiju_tools/docker/tests/test_containers.py
--rw-r--r--  2.0 unx      359 b- defN 23-Apr-19 12:08 kaiju_tools/docker/tests/test_images.py
--rw-r--r--  2.0 unx      371 b- defN 23-Apr-19 12:08 kaiju_tools/docker/tests/test_stack.py
--rw-r--r--  2.0 unx       65 b- defN 23-Apr-19 12:08 kaiju_tools/encoding/__init__.py
--rw-r--r--  2.0 unx     2996 b- defN 23-Apr-19 12:08 kaiju_tools/encoding/abc.py
--rw-r--r--  2.0 unx      163 b- defN 23-Apr-19 12:08 kaiju_tools/encoding/etc.py
--rw-r--r--  2.0 unx     4440 b- defN 23-Apr-19 12:08 kaiju_tools/encoding/json.py
--rw-r--r--  2.0 unx     4472 b- defN 23-Apr-19 12:08 kaiju_tools/encoding/msgpack.py
--rw-r--r--  2.0 unx      654 b- defN 23-Apr-19 12:08 kaiju_tools/encoding/serializers.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/encoding/tests/__init__.py
--rw-r--r--  2.0 unx      335 b- defN 23-Apr-19 12:08 kaiju_tools/encoding/tests/fixtures.py
--rw-r--r--  2.0 unx     1930 b- defN 23-Apr-19 12:08 kaiju_tools/encoding/tests/test_msgpack.py
--rw-r--r--  2.0 unx      325 b- defN 23-Apr-19 12:08 kaiju_tools/encoding/tests/test_serializers.py
--rw-r--r--  2.0 unx       46 b- defN 23-Apr-19 12:08 kaiju_tools/es/__init__.py
--rw-r--r--  2.0 unx    18302 b- defN 23-Apr-19 12:08 kaiju_tools/es/client.py
--rw-r--r--  2.0 unx     5559 b- defN 23-Apr-19 12:08 kaiju_tools/es/loader.py
--rw-r--r--  2.0 unx    17588 b- defN 23-Apr-19 12:08 kaiju_tools/es/schema.py
--rw-r--r--  2.0 unx       66 b- defN 23-Apr-19 12:08 kaiju_tools/es/services.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/es/tests/__init__.py
--rw-r--r--  2.0 unx     3463 b- defN 23-Apr-19 12:08 kaiju_tools/es/tests/fixtures.py
--rw-r--r--  2.0 unx       32 b- defN 23-Apr-19 12:08 kaiju_tools/http/__init__.py
--rw-r--r--  2.0 unx     6055 b- defN 23-Apr-19 12:08 kaiju_tools/http/client.py
--rw-r--r--  2.0 unx     1238 b- defN 23-Apr-19 12:08 kaiju_tools/http/middlewares.py
--rw-r--r--  2.0 unx     2742 b- defN 23-Apr-19 12:08 kaiju_tools/http/views.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/http/tests/__init__.py
--rw-r--r--  2.0 unx     1532 b- defN 23-Apr-19 12:08 kaiju_tools/http/tests/test_client.py
--rw-r--r--  2.0 unx     2392 b- defN 23-Apr-19 12:08 kaiju_tools/http/tests/test_rpc_rest_view.py
--rw-r--r--  2.0 unx     2344 b- defN 23-Apr-19 12:08 kaiju_tools/locks/__init__.py
--rw-r--r--  2.0 unx     9911 b- defN 23-Apr-19 12:08 kaiju_tools/locks/abc.py
--rw-r--r--  2.0 unx      393 b- defN 23-Apr-19 12:08 kaiju_tools/locks/etc.py
--rw-r--r--  2.0 unx      284 b- defN 23-Apr-19 12:08 kaiju_tools/locks/exceptions.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/locks/tests/__init__.py
--rw-r--r--  2.0 unx     1913 b- defN 23-Apr-19 12:08 kaiju_tools/locks/tests/test_locks.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/logging/__init__.py
--rw-r--r--  2.0 unx     3355 b- defN 23-Apr-19 12:08 kaiju_tools/logging/services.py
--rw-r--r--  2.0 unx    10173 b- defN 23-Apr-19 12:08 kaiju_tools/logging/types.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/logging/tests/__init__.py
--rw-r--r--  2.0 unx     1827 b- defN 23-Apr-19 12:08 kaiju_tools/logging/tests/test_loggers.py
--rw-r--r--  2.0 unx       43 b- defN 23-Apr-19 12:08 kaiju_tools/queues/__init__.py
--rw-r--r--  2.0 unx    12777 b- defN 23-Apr-19 12:08 kaiju_tools/queues/abc.py
--rw-r--r--  2.0 unx     3828 b- defN 23-Apr-19 12:08 kaiju_tools/queues/queue.py
--rw-r--r--  2.0 unx       33 b- defN 23-Apr-19 12:08 kaiju_tools/queues/services.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/queues/tests/__init__.py
--rw-r--r--  2.0 unx      722 b- defN 23-Apr-19 12:08 kaiju_tools/queues/tests/fixtures.py
--rw-r--r--  2.0 unx     1371 b- defN 23-Apr-19 12:08 kaiju_tools/queues/tests/test_queue.py
--rw-r--r--  2.0 unx       43 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/__init__.py
--rw-r--r--  2.0 unx    11883 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/abc.py
--rw-r--r--  2.0 unx     5111 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/client.py
--rw-r--r--  2.0 unx     3825 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/client_gen.py
--rw-r--r--  2.0 unx      116 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/context.py
--rw-r--r--  2.0 unx      544 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/etc.py
--rw-r--r--  2.0 unx     1762 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/jsonrpc.py
--rw-r--r--  2.0 unx    20558 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/server.py
--rw-r--r--  2.0 unx       71 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/services.py
--rw-r--r--  2.0 unx     6040 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/sessions.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/tests/__init__.py
--rw-r--r--  2.0 unx     4207 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/tests/fixtures.py
--rw-r--r--  2.0 unx     7842 b- defN 23-Apr-19 12:08 kaiju_tools/rpc/tests/test_rpc_server.py
--rw-r--r--  2.0 unx       38 b- defN 23-Apr-19 12:08 kaiju_tools/streams/__init__.py
--rw-r--r--  2.0 unx    24457 b- defN 23-Apr-19 12:08 kaiju_tools/streams/abc.py
--rw-r--r--  2.0 unx      152 b- defN 23-Apr-19 12:08 kaiju_tools/streams/etc.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/streams/tests/__init__.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/streams/tests/fixtures.py
--rw-r--r--  2.0 unx     5975 b- defN 23-Apr-19 12:08 kaiju_tools/streams/tests/test_streams.py
--rw-r--r--  2.0 unx        0 b- defN 23-Apr-19 12:08 kaiju_tools/tests/__init__.py
--rw-r--r--  2.0 unx     2016 b- defN 23-Apr-19 12:08 kaiju_tools/tests/fixtures.py
--rw-r--r--  2.0 unx     1408 b- defN 23-Apr-19 12:08 kaiju_tools/tests/test_class_registry.py
--rw-r--r--  2.0 unx     3385 b- defN 23-Apr-19 12:08 kaiju_tools/tests/test_mapping.py
--rw-r--r--  2.0 unx      481 b- defN 23-Apr-19 12:08 kaiju_tools/tests/test_serialization.py
--rw-r--r--  2.0 unx     2787 b- defN 23-Apr-19 12:08 kaiju_tools/tests/test_services.py
--rw-r--r--  2.0 unx     1554 b- defN 23-Apr-19 12:08 kaiju_tools/tests/test_templates.py
--rw-r--r--  2.0 unx      796 b- defN 23-Apr-19 12:08 kaiju_tools/tests/test_ttl_dict.py
--rw-rw-rw-  2.0 unx      610 b- defN 23-Apr-19 12:08 kaiju_tools-2.0.47.dist-info/LICENSE
--rw-r--r--  2.0 unx     3236 b- defN 23-Apr-19 12:08 kaiju_tools-2.0.47.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-19 12:08 kaiju_tools-2.0.47.dist-info/WHEEL
--rw-r--r--  2.0 unx       12 b- defN 23-Apr-19 12:08 kaiju_tools-2.0.47.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     9622 b- defN 23-Apr-19 12:08 kaiju_tools-2.0.47.dist-info/RECORD
-111 files, 397576 bytes uncompressed, 112742 bytes compressed:  71.6%
+Zip file size: 128534 bytes, number of entries: 111
+-rw-r--r--  2.0 unx     3424 b- defN 23-Apr-21 14:23 kaiju_tools/CLI.py
+-rw-r--r--  2.0 unx      272 b- defN 23-Apr-21 14:23 kaiju_tools/__init__.py
+-rw-r--r--  2.0 unx     7473 b- defN 23-Apr-21 14:23 kaiju_tools/class_registry.py
+-rw-r--r--  2.0 unx     6013 b- defN 23-Apr-21 14:23 kaiju_tools/exceptions.py
+-rw-r--r--  2.0 unx      997 b- defN 23-Apr-21 14:23 kaiju_tools/fixtures.py
+-rw-r--r--  2.0 unx     8965 b- defN 23-Apr-21 14:23 kaiju_tools/functions.py
+-rw-r--r--  2.0 unx     2172 b- defN 23-Apr-21 14:23 kaiju_tools/init_app.py
+-rw-r--r--  2.0 unx    18691 b- defN 23-Apr-21 14:23 kaiju_tools/jsonschema.py
+-rw-r--r--  2.0 unx      195 b- defN 23-Apr-21 14:23 kaiju_tools/loop.py
+-rw-r--r--  2.0 unx    13521 b- defN 23-Apr-21 14:23 kaiju_tools/mapping.py
+-rw-r--r--  2.0 unx      159 b- defN 23-Apr-21 14:23 kaiju_tools/serialization.py
+-rw-r--r--  2.0 unx     8221 b- defN 23-Apr-21 14:23 kaiju_tools/services.py
+-rw-r--r--  2.0 unx    14345 b- defN 23-Apr-21 14:23 kaiju_tools/templates.py
+-rw-r--r--  2.0 unx     4793 b- defN 23-Apr-21 14:23 kaiju_tools/ttl_dict.py
+-rw-r--r--  2.0 unx     3691 b- defN 23-Apr-21 14:23 kaiju_tools/types.py
+-rw-r--r--  2.0 unx     2595 b- defN 23-Apr-21 14:23 kaiju_tools/cache/__init__.py
+-rw-r--r--  2.0 unx    11339 b- defN 23-Apr-21 14:23 kaiju_tools/cache/abc.py
+-rw-r--r--  2.0 unx     2373 b- defN 23-Apr-21 14:23 kaiju_tools/cache/local_cache.py
+-rw-r--r--  2.0 unx       43 b- defN 23-Apr-21 14:23 kaiju_tools/cache/services.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/cache/tests/__init__.py
+-rw-r--r--  2.0 unx     2315 b- defN 23-Apr-21 14:23 kaiju_tools/cache/tests/test_cache.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/commands/__init__.py
+-rw-r--r--  2.0 unx      932 b- defN 23-Apr-21 14:23 kaiju_tools/config/__init__.py
+-rw-r--r--  2.0 unx     7661 b- defN 23-Apr-21 14:23 kaiju_tools/config/config_loader.py
+-rw-r--r--  2.0 unx     2975 b- defN 23-Apr-21 14:23 kaiju_tools/config/configurator.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/config/tests/__init__.py
+-rw-r--r--  2.0 unx      586 b- defN 23-Apr-21 14:23 kaiju_tools/config/tests/test_configurator.py
+-rw-r--r--  2.0 unx      276 b- defN 23-Apr-21 14:23 kaiju_tools/docker/__init__.py
+-rw-r--r--  2.0 unx     9554 b- defN 23-Apr-21 14:23 kaiju_tools/docker/containers.py
+-rw-r--r--  2.0 unx     7830 b- defN 23-Apr-21 14:23 kaiju_tools/docker/images.py
+-rw-r--r--  2.0 unx      103 b- defN 23-Apr-21 14:23 kaiju_tools/docker/services.py
+-rw-r--r--  2.0 unx    11140 b- defN 23-Apr-21 14:23 kaiju_tools/docker/stack.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/docker/tests/__init__.py
+-rw-r--r--  2.0 unx     1625 b- defN 23-Apr-21 14:23 kaiju_tools/docker/tests/fixtures.py
+-rw-r--r--  2.0 unx      575 b- defN 23-Apr-21 14:23 kaiju_tools/docker/tests/test_containers.py
+-rw-r--r--  2.0 unx      359 b- defN 23-Apr-21 14:23 kaiju_tools/docker/tests/test_images.py
+-rw-r--r--  2.0 unx      371 b- defN 23-Apr-21 14:23 kaiju_tools/docker/tests/test_stack.py
+-rw-r--r--  2.0 unx       65 b- defN 23-Apr-21 14:23 kaiju_tools/encoding/__init__.py
+-rw-r--r--  2.0 unx     2996 b- defN 23-Apr-21 14:23 kaiju_tools/encoding/abc.py
+-rw-r--r--  2.0 unx      163 b- defN 23-Apr-21 14:23 kaiju_tools/encoding/etc.py
+-rw-r--r--  2.0 unx     4457 b- defN 23-Apr-21 14:23 kaiju_tools/encoding/json.py
+-rw-r--r--  2.0 unx     4472 b- defN 23-Apr-21 14:23 kaiju_tools/encoding/msgpack.py
+-rw-r--r--  2.0 unx      654 b- defN 23-Apr-21 14:23 kaiju_tools/encoding/serializers.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/encoding/tests/__init__.py
+-rw-r--r--  2.0 unx      335 b- defN 23-Apr-21 14:23 kaiju_tools/encoding/tests/fixtures.py
+-rw-r--r--  2.0 unx     1930 b- defN 23-Apr-21 14:23 kaiju_tools/encoding/tests/test_msgpack.py
+-rw-r--r--  2.0 unx      325 b- defN 23-Apr-21 14:23 kaiju_tools/encoding/tests/test_serializers.py
+-rw-r--r--  2.0 unx       46 b- defN 23-Apr-21 14:23 kaiju_tools/es/__init__.py
+-rw-r--r--  2.0 unx    18302 b- defN 23-Apr-21 14:23 kaiju_tools/es/client.py
+-rw-r--r--  2.0 unx     5559 b- defN 23-Apr-21 14:23 kaiju_tools/es/loader.py
+-rw-r--r--  2.0 unx    17588 b- defN 23-Apr-21 14:23 kaiju_tools/es/schema.py
+-rw-r--r--  2.0 unx       66 b- defN 23-Apr-21 14:23 kaiju_tools/es/services.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/es/tests/__init__.py
+-rw-r--r--  2.0 unx     3463 b- defN 23-Apr-21 14:23 kaiju_tools/es/tests/fixtures.py
+-rw-r--r--  2.0 unx       32 b- defN 23-Apr-21 14:23 kaiju_tools/http/__init__.py
+-rw-r--r--  2.0 unx     6055 b- defN 23-Apr-21 14:23 kaiju_tools/http/client.py
+-rw-r--r--  2.0 unx     1238 b- defN 23-Apr-21 14:23 kaiju_tools/http/middlewares.py
+-rw-r--r--  2.0 unx     3692 b- defN 23-Apr-21 14:23 kaiju_tools/http/views.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/http/tests/__init__.py
+-rw-r--r--  2.0 unx     1532 b- defN 23-Apr-21 14:23 kaiju_tools/http/tests/test_client.py
+-rw-r--r--  2.0 unx     2392 b- defN 23-Apr-21 14:23 kaiju_tools/http/tests/test_rpc_rest_view.py
+-rw-r--r--  2.0 unx     2344 b- defN 23-Apr-21 14:23 kaiju_tools/locks/__init__.py
+-rw-r--r--  2.0 unx     9351 b- defN 23-Apr-21 14:23 kaiju_tools/locks/abc.py
+-rw-r--r--  2.0 unx      393 b- defN 23-Apr-21 14:23 kaiju_tools/locks/etc.py
+-rw-r--r--  2.0 unx      284 b- defN 23-Apr-21 14:23 kaiju_tools/locks/exceptions.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/locks/tests/__init__.py
+-rw-r--r--  2.0 unx     1913 b- defN 23-Apr-21 14:23 kaiju_tools/locks/tests/test_locks.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/logging/__init__.py
+-rw-r--r--  2.0 unx     3355 b- defN 23-Apr-21 14:23 kaiju_tools/logging/services.py
+-rw-r--r--  2.0 unx    10173 b- defN 23-Apr-21 14:23 kaiju_tools/logging/types.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/logging/tests/__init__.py
+-rw-r--r--  2.0 unx     1827 b- defN 23-Apr-21 14:23 kaiju_tools/logging/tests/test_loggers.py
+-rw-r--r--  2.0 unx       43 b- defN 23-Apr-21 14:23 kaiju_tools/queues/__init__.py
+-rw-r--r--  2.0 unx    12777 b- defN 23-Apr-21 14:23 kaiju_tools/queues/abc.py
+-rw-r--r--  2.0 unx     3828 b- defN 23-Apr-21 14:23 kaiju_tools/queues/queue.py
+-rw-r--r--  2.0 unx       33 b- defN 23-Apr-21 14:23 kaiju_tools/queues/services.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/queues/tests/__init__.py
+-rw-r--r--  2.0 unx      722 b- defN 23-Apr-21 14:23 kaiju_tools/queues/tests/fixtures.py
+-rw-r--r--  2.0 unx     1371 b- defN 23-Apr-21 14:23 kaiju_tools/queues/tests/test_queue.py
+-rw-r--r--  2.0 unx       43 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/__init__.py
+-rw-r--r--  2.0 unx    11883 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/abc.py
+-rw-r--r--  2.0 unx     5111 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/client.py
+-rw-r--r--  2.0 unx     3825 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/client_gen.py
+-rw-r--r--  2.0 unx      116 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/context.py
+-rw-r--r--  2.0 unx      544 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/etc.py
+-rw-r--r--  2.0 unx     1762 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/jsonrpc.py
+-rw-r--r--  2.0 unx    21815 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/server.py
+-rw-r--r--  2.0 unx       71 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/services.py
+-rw-r--r--  2.0 unx     6259 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/sessions.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/tests/__init__.py
+-rw-r--r--  2.0 unx     4207 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/tests/fixtures.py
+-rw-r--r--  2.0 unx     7845 b- defN 23-Apr-21 14:23 kaiju_tools/rpc/tests/test_rpc_server.py
+-rw-r--r--  2.0 unx       38 b- defN 23-Apr-21 14:23 kaiju_tools/streams/__init__.py
+-rw-r--r--  2.0 unx    24589 b- defN 23-Apr-21 14:23 kaiju_tools/streams/abc.py
+-rw-r--r--  2.0 unx      152 b- defN 23-Apr-21 14:23 kaiju_tools/streams/etc.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/streams/tests/__init__.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/streams/tests/fixtures.py
+-rw-r--r--  2.0 unx     5975 b- defN 23-Apr-21 14:23 kaiju_tools/streams/tests/test_streams.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Apr-21 14:23 kaiju_tools/tests/__init__.py
+-rw-r--r--  2.0 unx     2016 b- defN 23-Apr-21 14:23 kaiju_tools/tests/fixtures.py
+-rw-r--r--  2.0 unx     1408 b- defN 23-Apr-21 14:23 kaiju_tools/tests/test_class_registry.py
+-rw-r--r--  2.0 unx     3385 b- defN 23-Apr-21 14:23 kaiju_tools/tests/test_mapping.py
+-rw-r--r--  2.0 unx      481 b- defN 23-Apr-21 14:23 kaiju_tools/tests/test_serialization.py
+-rw-r--r--  2.0 unx     2787 b- defN 23-Apr-21 14:23 kaiju_tools/tests/test_services.py
+-rw-r--r--  2.0 unx     1554 b- defN 23-Apr-21 14:23 kaiju_tools/tests/test_templates.py
+-rw-r--r--  2.0 unx      796 b- defN 23-Apr-21 14:23 kaiju_tools/tests/test_ttl_dict.py
+-rw-rw-rw-  2.0 unx      610 b- defN 23-Apr-21 14:23 kaiju_tools-2.0.48.dist-info/LICENSE
+-rw-r--r--  2.0 unx     3236 b- defN 23-Apr-21 14:23 kaiju_tools-2.0.48.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-21 14:23 kaiju_tools-2.0.48.dist-info/WHEEL
+-rw-r--r--  2.0 unx       12 b- defN 23-Apr-21 14:23 kaiju_tools-2.0.48.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     9622 b- defN 23-Apr-21 14:23 kaiju_tools-2.0.48.dist-info/RECORD
+111 files, 399594 bytes uncompressed, 113216 bytes compressed:  71.7%
```

## zipnote {}

```diff
@@ -312,23 +312,23 @@
 
 Filename: kaiju_tools/tests/test_templates.py
 Comment: 
 
 Filename: kaiju_tools/tests/test_ttl_dict.py
 Comment: 
 
-Filename: kaiju_tools-2.0.47.dist-info/LICENSE
+Filename: kaiju_tools-2.0.48.dist-info/LICENSE
 Comment: 
 
-Filename: kaiju_tools-2.0.47.dist-info/METADATA
+Filename: kaiju_tools-2.0.48.dist-info/METADATA
 Comment: 
 
-Filename: kaiju_tools-2.0.47.dist-info/WHEEL
+Filename: kaiju_tools-2.0.48.dist-info/WHEEL
 Comment: 
 
-Filename: kaiju_tools-2.0.47.dist-info/top_level.txt
+Filename: kaiju_tools-2.0.48.dist-info/top_level.txt
 Comment: 
 
-Filename: kaiju_tools-2.0.47.dist-info/RECORD
+Filename: kaiju_tools-2.0.48.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## kaiju_tools/__init__.py

```diff
@@ -4,10 +4,10 @@
 from .es import *
 from .queues import *
 from .cache import *
 from .locks import *
 from .streams import *
 from .docker import *
 
-__version__ = '2.0.47'
+__version__ = '2.0.48'
 __python_version__ = '3.8'
 __author__ = 'antonnidhoggr@me.com'
```

## kaiju_tools/encoding/json.py

```diff
@@ -1,12 +1,12 @@
 from collections.abc import Mapping
 from enum import Enum
 from types import SimpleNamespace
 
-import rapidjson as rj
+import rapidjson as rj  # noqa pycharm?
 
 from .abc import SerializerInterface, Serializable
 from .etc import MimeTypes
 
 __all__ = ('dumps', 'dumps_bytes', 'loads', 'load', 'Serializer')
```

## kaiju_tools/http/views.py

```diff
@@ -1,61 +1,81 @@
+import asyncio
 from typing import cast
 
 from aiohttp.web import Request, Response, View, json_response, WebSocketResponse, WSMsgType
 from aiohttp.http_websocket import WSMessage
 from aiohttp_cors import CorsViewMixin
 
 from kaiju_tools.serialization import dumps, loads
-from kaiju_tools.services import Scope, Session
+from kaiju_tools.services import Scope, Session, ServiceContextManager
+from kaiju_tools.rpc.sessions import BaseSessionService
 from kaiju_tools.rpc.services import JSONRPCServer
 from kaiju_tools.rpc.etc import JSONRPCHeaders
 
 __all__ = ['JSONRPCView', 'jsonrpc_websocket_handler']
 
 
-async def jsonrpc_websocket_handler(request: Request, rpc_server_name: str = 'rpc'):
+async def jsonrpc_websocket_handler(
+    request: Request, rpc_server_name: str = None, session_service_name: str = None, validate_session: bool = True
+):
     """Read from websocket."""
     ws = WebSocketResponse()
     counter = 0
-    rpc: JSONRPCServer = getattr(request.app.services, rpc_server_name)  # noqa
+    services: ServiceContextManager = request.app.services  # noqa
+    rpc: JSONRPCServer = services.discover_service(rpc_server_name, cls=JSONRPCServer)
+    sessions: BaseSessionService = services.discover_service(session_service_name, cls=BaseSessionService)
     session: Session = request.get('session', None)
     scope: Scope = session.scope if session else Scope.GUEST
     headers = dict(request.headers)
 
     async def _send_response(_session: Session, headers: dict, result):  # noqa
         nonlocal session, scope, request
         session = request['session'] = _session
         scope = session.scope
         await ws.send_json(result.repr(), dumps=dumps)
 
     await ws.prepare(request)
 
-    async for msg in ws:
-        msg = cast(WSMessage, msg)
-        if msg.type == WSMsgType.TEXT:
-            if msg.data == 'close':
-                await ws.close()
-            else:
+    try:
+        async for msg in ws:
+            msg = cast(WSMessage, msg)
+            if msg.type == WSMsgType.ERROR:
+                request.app.logger.error('Websocket error: %s', ws.exception())
+            elif msg.type == WSMsgType.TEXT:
+                if msg.data == 'close':
+                    await ws.close()
+                    break
+
+                if validate_session:
+                    session_exists = await sessions.session_exists(session.id)
+                    if not session_exists:
+                        session = None  # noqa
+                        del request['session']
+                        await ws.close()
+                        break
+
                 data = loads(msg.data)
                 counter += 1
                 if 'id' not in data:
                     data['id'] = counter
                 result = await rpc.call(
                     data, headers=headers, session=session, scope=scope, nowait=True, callback=_send_response
                 )
-                if result:
-                    headers, exc = result
-                    await ws.send_json(exc.repr(), dumps=dumps)
-        elif msg.type == WSMsgType.ERROR:
-            request.app.logger.error('Websocket error: %s', ws.exception())
-
-    if session:
-        ws._headers[JSONRPCHeaders.SESSION_ID_HEADER] = session.id  # noqa
-
-    return ws
+                if type(result) is not asyncio.Task:
+                    _headers, result = result
+                    if result:
+                        await ws.send_json(result, dumps=dumps)
+    except Exception as exc:
+        request.app.logger.error('Websocket error', exc_info=exc)
+
+    finally:
+        ws._headers[JSONRPCHeaders.SESSION_ID_HEADER] = session.id if session else ''  # noqa
+        if not ws.closed:
+            await ws.close()
+        return ws
 
 
 class JSONRPCView(CorsViewMixin, View):
     """JSON RPC server endpoint."""
 
     route = '/public/rpc'
     rpc_server_name = 'rpc'
@@ -64,11 +84,11 @@
         """Make an RPC request."""
         if not self.request.can_read_body:
             return Response()
         data = await self.request.text()
         session: Session = self.request.get('session', None)
         scope: Scope = session.scope if session else Scope.GUEST
         rpc: JSONRPCServer = getattr(self.request.app.services, self.rpc_server_name)  # noqa
-        headers, data = await rpc.call(
+        headers, result = await rpc.call(
             loads(data), headers=dict(self.request.headers), session=session, scope=scope, nowait=False
         )
-        return json_response(data, headers=headers, dumps=dumps)
+        return json_response(result, headers=headers, dumps=dumps)
```

## kaiju_tools/locks/abc.py

```diff
@@ -1,10 +1,9 @@
 import abc
 import asyncio
-from random import random
 from time import time
 from typing import Optional
 
 from kaiju_tools.services import ContextableService, Service
 
 from .etc import StatusCodes
 from .exceptions import *
@@ -23,15 +22,14 @@
     backend specific lock service.
     """
 
     service_name = 'locks'
     WAIT_RELEASE_REFRESH_INTERVAL = 1  #: (s) interval between tries to acquire a used lock
     MIN_REFRESH_INTERVAL = 1  #: (s) minimal allowed refresh interval for the daemon
     REFRESH_INTERVAL = 60  #: (s) how often locks will be renewed by the daemon
-    JITTER = 0.01  #: refresh interval jitter (interval = interval * (1 + jitter))
     BASE_TTL = 2 * REFRESH_INTERVAL  #: (s) lifetime of a lock after each renewal
     PREFIX = 'lock'  #: default lock key prefix
     DELIMITER = ':'
     transport_cls = None
 
     def __init__(
         self,
@@ -53,35 +51,31 @@
         self._namespace = namespace if namespace else app['name']
         self._transport_name = transport
         self._refresh_interval = max(self.MIN_REFRESH_INTERVAL, int(refresh_interval))
         self._keys = {}
         self._closing = False
         self._transport = None
         self._daemon = None
-        self._task = None
-        self._task_event = None
 
     async def init(self):
+        """Initialize."""
         self._transport = self.discover_service(self._transport_name, cls=self.transport_cls)
         self._closing = False
-        self._task_event = asyncio.Event()
-        self._task_event.set()
         self._daemon = asyncio.create_task(self._loop())
+        self._daemon.set_name(f'{self.service_name}:loop')
         self._keys = {}
 
     @property
     def closed(self) -> bool:
+        """Service is closed."""
         return self._daemon is None
 
     async def close(self):
+        """Close."""
         self._closing = True
-        if self._task and not self._task.done():
-            await self._task_event.wait()
-        self._task = None
-        self._task_event = None
         self._daemon.cancel()
         self._daemon = None
 
     async def wait(self, key: str, timeout: float = None):
         """Wait for a lock and return when it's released.
 
         :param key: lock key name
@@ -228,17 +222,14 @@
 
     def _create_key(self, key: str):
         keys = (self.app.env, self._namespace, self.PREFIX, key)
         return self.DELIMITER.join((k for k in keys if k))
 
     async def _renew_keys(self):
         """Renews existing locks."""
-        await self._task_event.wait()
-        self._task_event.clear()
-
         t = int(time()) + 1
         keys, values, to_remove = [], [], []
 
         for key, deadline in self._keys.items():
             if deadline is None:
                 keys.append(self._create_key(key))
                 values.append(self.BASE_TTL)
@@ -248,30 +239,22 @@
                 keys.append(self._create_key(key))
                 ttl = min(deadline - t, self.BASE_TTL)
                 values.append(ttl)
 
         for key in to_remove:
             del self._keys[key]
 
-        try:
-            if keys:
-                await self._renew(keys, values)
-        finally:
-            self._task_event.set()
+        if keys:
+            await self._renew(keys, values)
 
     async def _loop(self):
         """Daemon which periodically starts a renew task."""
         refresh_interval = self._refresh_interval
-        jitter = self.JITTER
-
         while not self._closing:
             t = time()
-            if self._keys:
-                self._task = _task = asyncio.create_task(self._renew_keys())
-                try:
-                    await _task
-                except Exception as exc:
-                    self.logger.error('renew locks error', exc_info=exc)
-
+            try:
+                await self._renew_keys()
+            except Exception as exc:
+                self.logger.error('Renew locks error', exc_info=exc)
             t = time() - t
-            dt = max(refresh_interval * (1 + random() * jitter) - t, 0)
+            dt = max(refresh_interval - t, 0)
             await asyncio.sleep(dt)
```

## kaiju_tools/rpc/server.py

```diff
@@ -2,44 +2,50 @@
 import inspect
 import os
 import warnings
 from binascii import b2a_hex
 from fnmatch import fnmatch
 from textwrap import dedent
 from time import time
-from typing import List, Union, TypedDict, Callable, Dict, Optional, Tuple, Awaitable, NewType
+from typing import cast, List, Union, TypedDict, Callable, Dict, Optional, Tuple, Awaitable, NewType
 
 import fastjsonschema  # noqa pycharm?
 
 from kaiju_tools.rpc.abc import AbstractRPCCompatible
 from kaiju_tools.rpc.etc import JSONRPCHeaders
 from kaiju_tools.rpc.sessions import BaseSessionService
-from kaiju_tools.rpc.jsonrpc import RPCError, RPCResponse
+from kaiju_tools.rpc.jsonrpc import RPCError, RPCResponse, JSONRPC
 from kaiju_tools.functions import timeout
 from kaiju_tools.exceptions import (
     APIException,
     RequestTimeout,
     InternalError,
     InvalidRequest,
     InvalidParams,
     Aborted,
     MethodNotFound,
     PermissionDenied,
     JSONRPCError,
+    ClientError,
 )
 from kaiju_tools.services import ContextableService, RequestContext, Session, Scope
 from kaiju_tools.jsonschema import compile_schema
 from .context import REQUEST_CONTEXT, REQUEST_SESSION
 
 __all__ = ['RequestHeaders', 'MethodInfo', 'JSONRPCServer']
 
 
 _RequestId = NewType('_RequestId', Union[int, None])
 
 
+class _Task(asyncio.Task):
+    deadline: int
+    started: int
+
+
 class _Aborted(APIException):
     pass
 
 
 class RequestHeaders(TypedDict):
     """Request headers acknowledged by the server."""
 
@@ -129,63 +135,82 @@
 
     async def close(self):
         await self._empty.wait()
         await super().close()
 
     @property
     def routes(self):
-        return {'routes': self.get_routes, 'info': self.get_info}
+        return {'api': self.get_routes, 'status': self.get_status, 'tasks': self.get_tasks}
 
     @property
     def permissions(self):
         return {
-            'routes': self.PermissionKeys.GLOBAL_GUEST_PERMISSION,
-            'info': self.PermissionKeys.GLOBAL_SYSTEM_PERMISSION,
+            'api': self.PermissionKeys.GLOBAL_GUEST_PERMISSION,
+            'status': self.PermissionKeys.GLOBAL_SYSTEM_PERMISSION,
+            'tasks': self.PermissionKeys.GLOBAL_SYSTEM_PERMISSION,
         }
 
-    async def get_info(self) -> dict:
-        """Get server status and current tasks."""
+    @staticmethod
+    async def get_tasks() -> list:
+        """Get all current asyncio tasks."""
         tasks = asyncio.all_tasks(asyncio.get_running_loop())
         t = int(time())
+        tasks_info = []
+        for task in tasks:
+            name = task.get_name()
+            data = {'name': name}
+            if name.startswith('rpc:'):
+                task = cast(_Task, task)
+                data.update(
+                    {
+                        'system': False,
+                        'cid': name.split(':')[1],
+                        'time_elapsed': t - task.started,
+                        'time_left': task.deadline - task.started,
+                    }
+                )
+            else:
+                f_code = task.get_stack(limit=1)[-1].f_code
+                data.update({'system': True, 'coro': f_code.co_name})
+            tasks_info.append(data)
+
+        tasks_info.sort(key=lambda o: (o['system'], o['name']))
+        return tasks_info
+
+    async def get_status(self) -> dict:
+        """Get server status and current tasks."""
         return {
+            'app': self.app.name,
             'app_id': self.app.id,
-            'total_tasks': len(tasks),
+            'env': self.app.env,
+            'debug': self._debug,
             'rpc_tasks': self._max_parallel_tasks - self._counter,
             'queue_full': not self._not_full.is_set(),
-            'server_time': t,
+            'server_time': int(time()),
             'max_tasks': self._max_parallel_tasks,
             'max_timeout': self._max_request_time,
             'default_timeout': self._default_request_time,
             'enable_permissions': self._enable_permissions,
-            'tasks': [
-                {
-                    'cid': task.get_name()[4:],
-                    'time_elapsed': t - task.started,  # noqa (should be added in call)
-                    'time_left': task.deadline - task.started,  # noqa (should be added in call)
-                }
-                for task in tasks
-                if task.get_name().startswith('rpc:')
-            ],
         }
 
-    async def get_routes(self, pattern: str = '*') -> list:
+    async def get_routes(self, pattern: str = '*') -> dict:
         """Get all RPC routes (you are here)."""
         session = self.get_session()
         routes = [
             {
                 'route': route,
                 'permission': method['permission'].name,
                 'info': dedent(method['f'].__doc__.split('\n')[0]) if method['f'].__doc__ else None,
                 'signature': method['signature'],
             }
             for route, method in self._methods.items()
             if method['permission'].value >= session.scope.value and fnmatch(route, pattern)
         ]
         routes.sort(key=lambda o: o['route'])
-        return routes
+        return {'api': 'jsonrpc', 'version': JSONRPC, 'spec': 'https://www.jsonrpc.org/specification', 'routes': routes}
 
     def register_service(self, service_name: str, service: AbstractRPCCompatible) -> None:
         """Register an RPC compatible service and its methods."""
         if not isinstance(service, AbstractRPCCompatible):
             raise TypeError('Service must be rpc compatible.')
         permissions = service.permissions
         validators = service.validators
@@ -237,29 +262,31 @@
         :param scope: user scope
         :param nowait: do not wait for the result
         :param callback: optional response callback which should contain (session, headers, result) input params
         """
         headers = self._get_request_headers(headers)
         if type(body) in {list, tuple}:
             try:
-                reqs = [self._prepare_request(req, session, scope, n, nowait) for n, req in enumerate(body)]
+                reqs = [self._prepare_request(req, session, scope, n) for n, req in enumerate(body)]
+                return_result = any((req[0] is not None for req in reqs))
             except JSONRPCError as exc:
                 headers = self._get_response_headers(headers['correlation_id'], session)
                 return headers, RPCError(id=exc.data.get('id'), error=exc)
             coro = self._execute_batch(
                 reqs,
                 request_deadline=headers['request_deadline'],
                 abort_on_error=headers['abort_on_error'],
                 session=session,
                 correlation_id=headers['correlation_id'],
                 callback=callback,
             )
         else:
             try:
-                req_id, coro, body = self._prepare_request(body, session, scope, 0, nowait)
+                req_id, coro, body = self._prepare_request(body, session, scope, 0)
+                return_result = req_id is not None
             except JSONRPCError as exc:
                 headers = self._get_response_headers(headers['correlation_id'], session)
                 return headers, RPCError(id=exc.data.get('id'), error=exc)
             coro = self._execute_single(
                 coro,
                 request_id=req_id,
                 body=body,
@@ -277,18 +304,20 @@
         setattr(task, 'started', int(time()))
         task.add_done_callback(self._request_done_cb)
         if self._empty.is_set():
             self._empty.clear()
         if self._counter <= 0:
             self._counter = 0
             self._not_full.clear()
-        if nowait:
+        if not return_result:
+            return self._get_response_headers(headers['correlation_id'], session), None
+        elif nowait:
             return task
         else:
-            return await task  # noqa compatibility reasons
+            return await task
 
     @staticmethod
     def _parse_number_value(value, min_val, max_val, default) -> int:
         if not value:
             return default
         try:
             value = int(value)
@@ -349,16 +378,16 @@
             )
         session = self.get_session()
         if self._sessions and session and session.stored and session.changed:
             await self._sessions.save_session(session)
         if result.id is not None or type(result) is not RPCResponse:
             headers = self._get_response_headers(correlation_id, session)
             if callback:
-                coro = callback(session, headers, result)
-                asyncio.create_task(coro)  # noqa  TODO: find how to type hint callback properly
+                cb = asyncio.create_task(callback(session, headers, result))  # noqa
+                cb.set_name(f'rpc:{correlation_id}:callback')
             return headers, result
 
     @staticmethod
     def _get_response_headers(correlation_id: str, session: Optional[Session]) -> dict:
         headers = {}
         if correlation_id:
             headers[JSONRPCHeaders.CORRELATION_ID_HEADER] = correlation_id
@@ -411,27 +440,26 @@
                     results.append(result)
         session = self.get_session()
         if self._sessions and session and session.stored and session.changed:
             await self._sessions.save_session(session)
         headers = self._get_response_headers(correlation_id, session)
         if results:
             if callback:
-                await callback(session, headers, results)
+                cb = asyncio.create_task(callback(session, headers, results))  # noqa
+                cb.set_name(f'rpc:{correlation_id}:callback')
             return headers, results
 
     def _prepare_request(
-        self, body, session: Optional[Session], scope: Scope, default_id: int, nowait: bool
+        self, body, session: Optional[Session], scope: Scope, default_id: int
     ) -> (_RequestId, Awaitable):
         """Pre-validate and prepare request for the execution."""
         # request body validation
         if type(body) is not dict:
             raise InvalidRequest(id=None, message='Request must be an object')
-        if nowait:
-            body['id'] = _id = None
-        elif 'id' not in body:
+        if 'id' not in body:
             body['id'] = _id = default_id
         else:
             _id = body['id']
             if _id is not None and type(_id) is not int:
                 raise InvalidRequest(id=None, message='Request "id" must be an integer or null', request_id=_id)
 
         # method visibility check
@@ -490,18 +518,22 @@
             if not self._full_request_logs:
                 request['params'] = '...'
             self.logger.info('rpc accepted', request=request)
         try:
             result = await coro
             result = RPCResponse(id=request_id, result=result)
             _error = False
+        except ClientError as exc:
+            _error, result = True, exc
         except APIException as exc:
             _error, result = True, exc
+            self.logger.error('Internal error', exc_info=exc)
         except Exception as exc:
             _error, result = True, InternalError(base_exc=exc, message='Internal error')
+            self.logger.error('Internal error', exc_info=exc)
         if _error:
             if self._debug:
                 result.debug = True
             self.logger.info('rpc error', request=request, exc_info=result)
             result = RPCError(id=request_id, error=result)
         elif self._request_logs:
             _result = result.result if self._full_request_logs else '...'
```

## kaiju_tools/rpc/sessions.py

```diff
@@ -22,15 +22,15 @@
 
     def __init__(
         self,
         app,
         cache_service: BaseCacheService = None,
         session_idle_timeout: int = 24 * 3600,
         exp_renew_interval: int = 3600,
-        salt: str = 'SHT',
+        salt: str = 'SALT',
         logger=None,
     ):
         """Initialize.
 
         :param app:
         :param cache_service:
         :param session_idle_timeout: (s) Idle life timeout each session.
@@ -51,14 +51,19 @@
         :param user_agent: user agent or client id or hash to match session in subsequent requests
         """
         h_agent = self._get_agent_hash(user_agent) if type(user_agent) is str else user_agent
         session = self._create_new_session(data, h_agent)
         self.logger.debug('new session', session_id=session.id)
         return session
 
+    async def session_exists(self, session_id: str, /) -> bool:
+        """Check if session exists in the session cache."""
+        key = self._get_session_key(session_id)
+        return await self._cache.exists(key)
+
     async def save_session(self, session: Session, /) -> None:
         """Save session to the storage.
 
         The session will be stored only if it is marked as stored, and it has been changed.
         Token-auth sessions and initial sessions without data won't be stored.
         """
         if not session or not session.stored:
```

## kaiju_tools/rpc/tests/test_rpc_server.py

```diff
@@ -68,15 +68,15 @@
 
         data = {'method': 'm.echo'}
         _headers, response = await rpc.call(data, {})
         assert response.result == ((), {})
 
         data = {'id': None, 'method': 'm.echo'}
         _result = await rpc.call(data, {})
-        assert _result is None
+        assert _result[1] is None
 
         data = {'id': uuid4().int, 'method': 'm.echo', 'params': {'value': 42}}
         _headers, response = await rpc.call(data, {})
         assert response.result[1]['value'] == 42
 
         data = {'id': uuid4().int, 'method': 'm.aecho', 'params': {'a': 1, 'b': 2, 'c': 3}}
         _headers, response = await rpc.call(data, {})
```

## kaiju_tools/streams/abc.py

```diff
@@ -81,14 +81,15 @@
         self._unlocked = asyncio.Event()
 
     async def init(self):
         self._closing = False
         await self._locks.wait(self.locking_key, timeout=None)
         self._unlocked.set()
         self._task = asyncio.create_task(self._loop())
+        self._task.set_name(f'{self.service_name}:{self.topic_name}:loop')
         await self._ready.wait()
 
     @property
     def closed(self) -> bool:
         return self._task is None
 
     async def close(self):
@@ -487,14 +488,15 @@
         )
         await self._producer.init()
         for topic in self.topics:
             await self._producer.init_topic(topic)
 
         await self._init()
         self._task = asyncio.create_task(self._loop())
+        self._task.set_name(f'{self.service_name}:loop')
 
     def closed(self):
         return self._consumers is None
 
     async def close(self):
         if not self.closed:
             self._closing = True
```

## Comparing `kaiju_tools-2.0.47.dist-info/LICENSE` & `kaiju_tools-2.0.48.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `kaiju_tools-2.0.47.dist-info/METADATA` & `kaiju_tools-2.0.48.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: kaiju-tools
-Version: 2.0.47
+Version: 2.0.48
 Summary: Base classes and services for a backend application.
 Home-page: https://gitlab.com/kaiju-python/kaiju-tools
 Author: antonnidhoggr@me.com
 Author-email: antonnidhoggr@me.com
 License: Apache Software License 2.0
 Classifier: Development Status :: 3 - Alpha
 Classifier: License :: OSI Approved :: Apache Software License
```

## Comparing `kaiju_tools-2.0.47.dist-info/RECORD` & `kaiju_tools-2.0.48.dist-info/RECORD`

 * *Files 4% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 kaiju_tools/CLI.py,sha256=JAggZ74FQZmu-Wr5vYzy0-dMB5zH3vQewDGe2lnW5eo,3424
-kaiju_tools/__init__.py,sha256=YMTU8MBYJBGwrOWyJZdftGNpH32L5MHA1hjzX9jPARI,272
+kaiju_tools/__init__.py,sha256=WJNFnJDar4RhlEJurglUBf88yEB8AB1o9ld_cI4SAMg,272
 kaiju_tools/class_registry.py,sha256=sKn9YmblEeTBhcC_ivoGGTlBFXMG2G2WAsztdk1xBcE,7473
 kaiju_tools/exceptions.py,sha256=DJrtHxE3oWR9p7il2E8Q3r0P-JSKcDkwo57lcy74604,6013
 kaiju_tools/fixtures.py,sha256=h1ElRgENikjde-uXvk_exA_SvMPuxqtxo0qaiYDhCWk,997
 kaiju_tools/functions.py,sha256=LVxnviuH2wwif3TChnXOcNOR9WCWMnafqezV27pRBEc,8965
 kaiju_tools/init_app.py,sha256=J5eDuiZqskrBWSjgM2d8CdsYkt28nqgrOLT4Ms8AZjg,2172
 kaiju_tools/jsonschema.py,sha256=1akEqwrcaD7wgvTmEUpkjRrvw7ILWh8iPfn8YRGK0h8,18691
 kaiju_tools/loop.py,sha256=Nkih75UgPen5SvZYSU0XFb9cbH6Zle-Nbto0B_wpn50,195
@@ -34,15 +34,15 @@
 kaiju_tools/docker/tests/fixtures.py,sha256=0bx6BE7id5Rz52y3nEVXx0ZNjzPuDe_T9C6Jzq4iHaU,1625
 kaiju_tools/docker/tests/test_containers.py,sha256=Yugtil6wQs2DGp6W0lNJM0ZoihzG5d95z0u5StGIfJ0,575
 kaiju_tools/docker/tests/test_images.py,sha256=XDJ1Z3XQSQswiJxDO_QtKmw4NymJpXhSdvHtxCGg8rE,359
 kaiju_tools/docker/tests/test_stack.py,sha256=qa6UbjCBiVmAORKyWTs9HaArZF0ZLBDZSzGJlc3Bjhs,371
 kaiju_tools/encoding/__init__.py,sha256=hLMiGsFxCgusvfnq4MOPgI3jMGezZyU_KvE9qn80W3s,65
 kaiju_tools/encoding/abc.py,sha256=QaHLzs7PfS35wL26V_RCMId3v7DQq6k5J91t7DEdW1Y,2996
 kaiju_tools/encoding/etc.py,sha256=8YKb6OZrb0is64xlvGkowUR2b_ivnzsW1IhZoMv8a3g,163
-kaiju_tools/encoding/json.py,sha256=HsN9jjZowzzw3wbA6bHDtLfIu4wOzbxBx_iLQGGjeOA,4440
+kaiju_tools/encoding/json.py,sha256=A_8vr6cwsnoUGd6PkCEKbgd5jIjyk9-3aKIh--O02jQ,4457
 kaiju_tools/encoding/msgpack.py,sha256=HAs_6K6FGRAsPwS6XRHmBgMhdvbGPLK5os-CRZcObgY,4472
 kaiju_tools/encoding/serializers.py,sha256=EXcSZAsrEU3OPGJkGfCVKDVZ8KZNxfDYb2-hPAOMbbM,654
 kaiju_tools/encoding/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kaiju_tools/encoding/tests/fixtures.py,sha256=6DhYjUkjud_7_AuTqpPxlbKqs3i7xWhv4cNcZIU97k0,335
 kaiju_tools/encoding/tests/test_msgpack.py,sha256=lqyZmedAJE2RMUqVI88Fr6tQoAOl30u77qdNf1BEI6I,1930
 kaiju_tools/encoding/tests/test_serializers.py,sha256=cSn1tIfRkpB_sZ_eHbnK-B94NPmEYMnFCf_nPPbMLcM,325
 kaiju_tools/es/__init__.py,sha256=_lGbw9UADok07fqeMvLlZGHefDsJ7wppstJ8qkME_9k,46
@@ -51,20 +51,20 @@
 kaiju_tools/es/schema.py,sha256=dvf4yhWGxPEAcWQv1LeIJNU9_Yc6Dcm0lxIl9TwE8hI,17588
 kaiju_tools/es/services.py,sha256=XLYIrzW4QnfsqWYK9vLT43i5dHqICAza6E1vEP0NVyw,66
 kaiju_tools/es/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kaiju_tools/es/tests/fixtures.py,sha256=x4kOyRAGt6tqACFbojRNxqNITdE1_V_TRxWybf9h2dE,3463
 kaiju_tools/http/__init__.py,sha256=WjPNiFMweQ3tqGMUeqV4ubNc7GDRicBffNEmyqBhnw4,32
 kaiju_tools/http/client.py,sha256=Ez0zGImFx-5OfldOsMojG01r3LVUn9qkYZ_LeM_b4EU,6055
 kaiju_tools/http/middlewares.py,sha256=-mpWy-BnWVvlwliLBgQ8ZG_o2R4m1Mb7PDWmFpAo7Cs,1238
-kaiju_tools/http/views.py,sha256=GkZO-rNRp-n02xb46kH_LshmXo0-kq93KHfPCxfuXfo,2742
+kaiju_tools/http/views.py,sha256=l1p-9ggiwG_4twpFfNAtasv4TDJiJNai0trTkca9bHs,3692
 kaiju_tools/http/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kaiju_tools/http/tests/test_client.py,sha256=pBmui1LF98Z5v-kadTCvvdDXSfufeuBkraAg4kJ2s_Y,1532
 kaiju_tools/http/tests/test_rpc_rest_view.py,sha256=quDgkyns94NU1fHG2hTqVLcpGDpmiM9cJlR6vLSIpOY,2392
 kaiju_tools/locks/__init__.py,sha256=bkVd3bN1kZCPi3PfnV7ZQLHWjq86vAf-aE2ZVNZF5ug,2344
-kaiju_tools/locks/abc.py,sha256=vgpYLSlPQcMzUO_1mbnOJ3_NHMBtHg_p3mAEULucVxs,9911
+kaiju_tools/locks/abc.py,sha256=jcGUOuZD4a2nxqQojbvcspOS4RGAqBrjg1VaPcAlh1U,9351
 kaiju_tools/locks/etc.py,sha256=TFrcXD-qJg1ZDp6-2Wy6bLC1DCHB9XAji8WQ7oxYt-A,393
 kaiju_tools/locks/exceptions.py,sha256=ZCo4Q8IMbbOe81raMdDi6j-M1kQ2wdv1PbuR9Fsr9x8,284
 kaiju_tools/locks/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kaiju_tools/locks/tests/test_locks.py,sha256=ygFVC-BTEgW_G6fBMDGAw2Y5mgZWt7xz9yfrilDKOeM,1913
 kaiju_tools/logging/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kaiju_tools/logging/services.py,sha256=Q24V4UVrJJyEVMKkQYrOi4pWsKmuAnKTwKGRAgTypxM,3355
 kaiju_tools/logging/types.py,sha256=j9W7RV0uwH10fy75Lobi92TVKU-IVdnIebc8RPQHwKs,10173
@@ -80,32 +80,32 @@
 kaiju_tools/rpc/__init__.py,sha256=1_nq0D65USGIS2jXxF_88fR-LfaiXXF-PqNBTlpkWkg,43
 kaiju_tools/rpc/abc.py,sha256=XfmsF66rP3wvW0_LGPx3JpU4NF_NWqNZg-DLDBb8Nzw,11883
 kaiju_tools/rpc/client.py,sha256=mjbdx2kL2ZWuG6cLFfeLw4eygsX0LI6Ax6SqL3xNjOw,5111
 kaiju_tools/rpc/client_gen.py,sha256=pL3afEvDJIlD5SorfEtSj64Ef5JolYLTkVYPs3fpohw,3825
 kaiju_tools/rpc/context.py,sha256=l27TATs8IKs4f_690JRn75WY7TsjXWInDgqUrCP03FU,116
 kaiju_tools/rpc/etc.py,sha256=rUByIq3pv6hQektlthEeyWrRjloWPLuokNMK7frWZ9k,544
 kaiju_tools/rpc/jsonrpc.py,sha256=aZ2NE8vczDsdOe8EjlzqmliGLlmbwxNkmSoUeSSSJg8,1762
-kaiju_tools/rpc/server.py,sha256=0_8qIfCjhfTsZxaQSGhtte9bwFOAaPC6QfHsAYAFbKk,20558
+kaiju_tools/rpc/server.py,sha256=Nl4Z0Tfh0sOsJQp8UasfO4D3bAm8kHJdENEa5Kimv4A,21815
 kaiju_tools/rpc/services.py,sha256=FgR7DpZTKjYBx7ieXKHkh4Lqrqe910c_iAiKxTOcdIk,71
-kaiju_tools/rpc/sessions.py,sha256=PfE_EfoP-Ilgp6RI_AvavkVfog8R4FGAQIYuZnv3OoE,6040
+kaiju_tools/rpc/sessions.py,sha256=cSXssImSl2Wl8JmjITibpdSMqdUFap7dqKWS52MOCug,6259
 kaiju_tools/rpc/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kaiju_tools/rpc/tests/fixtures.py,sha256=6NUdBeZA3a_vrRe5oLTyDGU3FCqD5JwqZlXd1xFpsb8,4207
-kaiju_tools/rpc/tests/test_rpc_server.py,sha256=O-WLG9JMoxZKboy7KoEZAv3yNYmU0PHc5J9kHwdG1W4,7842
+kaiju_tools/rpc/tests/test_rpc_server.py,sha256=3iuyAw4N9HHUe7qMfVtD6k5XyCrBW0YVadsWq7CMbBI,7845
 kaiju_tools/streams/__init__.py,sha256=pHOdZ9DDYEMdr3EjCBCuNqYGY1hLqWwTU2v64vPCHP4,38
-kaiju_tools/streams/abc.py,sha256=K7D3HESwaYNZ_frxFKeTS92sDP4Qul2821T_7Z5hp2I,24457
+kaiju_tools/streams/abc.py,sha256=X9zEePueM7dbL3qrEKuIrnNP3lT6oy70btlBzh4Nhec,24589
 kaiju_tools/streams/etc.py,sha256=xAaOal-vRdGluvVOL698eY7TdpV-lboqH39DEFWeP5c,152
 kaiju_tools/streams/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kaiju_tools/streams/tests/fixtures.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kaiju_tools/streams/tests/test_streams.py,sha256=xB-Dv5RppQMi66U-aZ1IdfJ147ZDdpjM-nCrAjJCdP4,5975
 kaiju_tools/tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 kaiju_tools/tests/fixtures.py,sha256=k1Ou6JiYt4XM4-6zMVzO23fPyD4yFslrF3gbbwl6SlU,2016
 kaiju_tools/tests/test_class_registry.py,sha256=D9mZu9sgY21gEWE8vp2HN0Vfb5WZqxWTNVRPWEPduhU,1408
 kaiju_tools/tests/test_mapping.py,sha256=HzxgQo-k2cBPE88F4AnhBv_Ixb0YS-dWL5rQtM_MRVE,3385
 kaiju_tools/tests/test_serialization.py,sha256=9ETlE5i8b2WFwKsTrECVuB14Pkxf4QgCc6oFX_yjMZw,481
 kaiju_tools/tests/test_services.py,sha256=fYhWYsp-aAyIYwAcLx0ScZhBLBPEX6Apf2LRVWe-WX8,2787
 kaiju_tools/tests/test_templates.py,sha256=XQfGPY1FEIUhZZg4DZQYGTS887xFlPEfyQf0USjJYOw,1554
 kaiju_tools/tests/test_ttl_dict.py,sha256=HWuoDepQdEWixOBlYhCzR1RVLHz20jXwa4SWrrr0A7o,796
-kaiju_tools-2.0.47.dist-info/LICENSE,sha256=XIlN2qA8UqpBDA-PteoYP4hTU0qBW0G9PRB__khO2zc,610
-kaiju_tools-2.0.47.dist-info/METADATA,sha256=I1p1U69WEx93RjygZXcCaHIfzFtZroHD5o3w1efu_uU,3236
-kaiju_tools-2.0.47.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-kaiju_tools-2.0.47.dist-info/top_level.txt,sha256=DIgXUScFnJtRLiRWfjo547JK4rMuTIJoioMPRe1Jn6Y,12
-kaiju_tools-2.0.47.dist-info/RECORD,,
+kaiju_tools-2.0.48.dist-info/LICENSE,sha256=XIlN2qA8UqpBDA-PteoYP4hTU0qBW0G9PRB__khO2zc,610
+kaiju_tools-2.0.48.dist-info/METADATA,sha256=TiRrkUQbQAOFThZhNqJhFYh8zjsC8TL6vtUYTQM3g_4,3236
+kaiju_tools-2.0.48.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+kaiju_tools-2.0.48.dist-info/top_level.txt,sha256=DIgXUScFnJtRLiRWfjo547JK4rMuTIJoioMPRe1Jn6Y,12
+kaiju_tools-2.0.48.dist-info/RECORD,,
```

