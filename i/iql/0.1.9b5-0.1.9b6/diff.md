# Comparing `tmp/iql-0.1.9b5-py3-none-any.whl.zip` & `tmp/iql-0.1.9b6-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,27 +1,27 @@
-Zip file size: 47431 bytes, number of entries: 25
--rw-r--r--  2.0 unx      334 b- defN 23-Apr-21 12:33 iql/__init__.py
--rw-r--r--  2.0 unx      103 b- defN 23-Apr-21 12:34 iql/_version.py
--rw-r--r--  2.0 unx    34700 b- defN 23-Apr-21 12:33 iql/iqmoql.py
--rw-r--r--  2.0 unx     1282 b- defN 23-Apr-21 12:33 iql/options_parser.py
--rw-r--r--  2.0 unx     3233 b- defN 23-Apr-21 12:33 iql/q_cache.py
--rw-r--r--  2.0 unx     2191 b- defN 23-Apr-21 12:33 iql/threading_experimental.py
--rw-r--r--  2.0 unx       77 b- defN 23-Apr-21 12:33 iql/bbg_bql/__init__.py
--rw-r--r--  2.0 unx    10069 b- defN 23-Apr-21 12:33 iql/bbg_bql/bql_datamodel.py
--rw-r--r--  2.0 unx     8975 b- defN 23-Apr-21 12:33 iql/bbg_bql/bql_extension.py
--rw-r--r--  2.0 unx    13694 b- defN 23-Apr-21 12:33 iql/bbg_bql/bql_wrapper.py
--rw-r--r--  2.0 unx      692 b- defN 23-Apr-21 12:33 iql/bbg_bql/debug_tools.py
--rw-r--r--  2.0 unx       77 b- defN 23-Apr-21 12:33 iql/db_connectors/__init__.py
--rw-r--r--  2.0 unx     3253 b- defN 23-Apr-21 12:33 iql/db_connectors/duckdb_connector.py
--rw-r--r--  2.0 unx       77 b- defN 23-Apr-21 12:33 iql/extensions/__init__.py
--rw-r--r--  2.0 unx     3470 b- defN 23-Apr-21 12:33 iql/extensions/aws_s3_extension.py
--rw-r--r--  2.0 unx     7829 b- defN 23-Apr-21 12:33 iql/extensions/edgar_extension.py
--rw-r--r--  2.0 unx     4279 b- defN 23-Apr-21 12:33 iql/extensions/fred_extension.py
--rw-r--r--  2.0 unx     4106 b- defN 23-Apr-21 12:33 iql/extensions/kaggle_extension.py
--rw-r--r--  2.0 unx     2315 b- defN 23-Apr-21 12:33 iql/extensions/pandas_extension.py
--rw-r--r--  2.0 unx      666 b- defN 23-Apr-21 12:33 iql/extensions/template_extension.py
--rw-r--r--  2.0 unx      535 b- defN 23-Apr-21 12:34 iql-0.1.9b5.dist-info/LICENSE
--rw-r--r--  2.0 unx    27298 b- defN 23-Apr-21 12:34 iql-0.1.9b5.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-21 12:34 iql-0.1.9b5.dist-info/WHEEL
--rw-r--r--  2.0 unx        4 b- defN 23-Apr-21 12:34 iql-0.1.9b5.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2041 b- defN 23-Apr-21 12:34 iql-0.1.9b5.dist-info/RECORD
-25 files, 131392 bytes uncompressed, 44145 bytes compressed:  66.4%
+Zip file size: 47470 bytes, number of entries: 25
+-rw-r--r--  2.0 unx      372 b- defN 23-Apr-21 12:49 iql/__init__.py
+-rw-r--r--  2.0 unx      103 b- defN 23-Apr-21 12:49 iql/_version.py
+-rw-r--r--  2.0 unx    33829 b- defN 23-Apr-21 12:49 iql/iqmoql.py
+-rw-r--r--  2.0 unx     1282 b- defN 23-Apr-21 12:49 iql/options_parser.py
+-rw-r--r--  2.0 unx     3233 b- defN 23-Apr-21 12:49 iql/q_cache.py
+-rw-r--r--  2.0 unx     2191 b- defN 23-Apr-21 12:49 iql/threading_experimental.py
+-rw-r--r--  2.0 unx       77 b- defN 23-Apr-21 12:49 iql/bbg_bql/__init__.py
+-rw-r--r--  2.0 unx    10069 b- defN 23-Apr-21 12:49 iql/bbg_bql/bql_datamodel.py
+-rw-r--r--  2.0 unx     8975 b- defN 23-Apr-21 12:49 iql/bbg_bql/bql_extension.py
+-rw-r--r--  2.0 unx    13694 b- defN 23-Apr-21 12:49 iql/bbg_bql/bql_wrapper.py
+-rw-r--r--  2.0 unx      692 b- defN 23-Apr-21 12:49 iql/bbg_bql/debug_tools.py
+-rw-r--r--  2.0 unx       77 b- defN 23-Apr-21 12:49 iql/db_connectors/__init__.py
+-rw-r--r--  2.0 unx     4311 b- defN 23-Apr-21 12:49 iql/db_connectors/duckdb_connector.py
+-rw-r--r--  2.0 unx       77 b- defN 23-Apr-21 12:49 iql/extensions/__init__.py
+-rw-r--r--  2.0 unx     3470 b- defN 23-Apr-21 12:49 iql/extensions/aws_s3_extension.py
+-rw-r--r--  2.0 unx     7829 b- defN 23-Apr-21 12:49 iql/extensions/edgar_extension.py
+-rw-r--r--  2.0 unx     4279 b- defN 23-Apr-21 12:49 iql/extensions/fred_extension.py
+-rw-r--r--  2.0 unx     4106 b- defN 23-Apr-21 12:49 iql/extensions/kaggle_extension.py
+-rw-r--r--  2.0 unx     2315 b- defN 23-Apr-21 12:49 iql/extensions/pandas_extension.py
+-rw-r--r--  2.0 unx      666 b- defN 23-Apr-21 12:49 iql/extensions/template_extension.py
+-rw-r--r--  2.0 unx      535 b- defN 23-Apr-21 12:50 iql-0.1.9b6.dist-info/LICENSE
+-rw-r--r--  2.0 unx    27298 b- defN 23-Apr-21 12:50 iql-0.1.9b6.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-21 12:50 iql-0.1.9b6.dist-info/WHEEL
+-rw-r--r--  2.0 unx        4 b- defN 23-Apr-21 12:50 iql-0.1.9b6.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2041 b- defN 23-Apr-21 12:50 iql-0.1.9b6.dist-info/RECORD
+25 files, 131617 bytes uncompressed, 44184 bytes compressed:  66.4%
```

## zipnote {}

```diff
@@ -54,23 +54,23 @@
 
 Filename: iql/extensions/pandas_extension.py
 Comment: 
 
 Filename: iql/extensions/template_extension.py
 Comment: 
 
-Filename: iql-0.1.9b5.dist-info/LICENSE
+Filename: iql-0.1.9b6.dist-info/LICENSE
 Comment: 
 
-Filename: iql-0.1.9b5.dist-info/METADATA
+Filename: iql-0.1.9b6.dist-info/METADATA
 Comment: 
 
-Filename: iql-0.1.9b5.dist-info/WHEEL
+Filename: iql-0.1.9b6.dist-info/WHEEL
 Comment: 
 
-Filename: iql-0.1.9b5.dist-info/top_level.txt
+Filename: iql-0.1.9b6.dist-info/top_level.txt
 Comment: 
 
-Filename: iql-0.1.9b5.dist-info/RECORD
+Filename: iql-0.1.9b6.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## iql/__init__.py

```diff
@@ -7,10 +7,12 @@
     configure,
     get_extension,
     list_extensions,
     register_extension,
 )
 from iql.q_cache import clear_caches
 
+from iql._version import __version__
+
 # import logging
 
 # log_to_stderr(logging.INFO)
```

## iql/_version.py

```diff
@@ -1,3 +1,3 @@
-__version__="0.1.9b5"
-__commit__="45fd902de7e8fcbbe77c14878ac7e370f10a7e73"
-__commit_short__="45fd902"
+__version__="0.1.9b6"
+__commit__="59351d7d962a00b6c73ee3baac1288ac58973e1e"
+__commit_short__="59351d7"
```

## iql/iqmoql.py

```diff
@@ -5,15 +5,14 @@
 import sqlparse
 import importlib
 import os
 import re
 from dataclasses import dataclass, field
 from typing import List, Dict, Optional, Union, Tuple, Callable
 from pandas import DataFrame
-from pyarrow import Table
 import pandas as pd
 from abc import abstractmethod
 from iql import q_cache as qc
 from iql import options_parser
 from iql import threading_experimental as te
 
 
@@ -109,53 +108,24 @@
         )
 
         results.append((keyword, subword, outer, inner))
 
     return results
 
 
-def rename_dupe_arrow_columns(pat: Table) -> Table:
-    # PyArrow can't export to Pandas if there are duplicate columns
-    cols = pat.column_names
-    unique_cols = set(cols)
-
-    if len(unique_cols) == len(cols):
-        # everything is unique
-        return pat
-    else:
-        newcols = []
-        print(f"Has dupes, {cols}")
-        seen = set()
-        for col in cols:
-            if col not in seen:
-                seen.add(col)
-                newcols.append(col)
-            else:
-                idx = 1
-                while (newcol := f"{col}_{idx}") in seen or newcol in unique_cols:
-                    idx += 1
-                newcols.append(newcol)
-
-        pat = pat.rename_columns(newcols)
-
-        return pat
-
-
 @dataclass
 class IqlResult:
-    _table: Table
-
     def arrow(self):
-        return self._table
+        pass
 
     def df_numpy(self):
-        return self._table.to_pandas()
+        pass
 
     def df_arrow(self):
-        return self._table.to_pandas(types_mapper=pd.ArrowDtype)
+        pass
 
 
 class IqlDatabase:
     @abstractmethod
     def execute_query(
         self, query: str, completed_dfs: Dict[str, DataFrame]
     ) -> Optional[IqlResult]:
```

## iql/db_connectors/duckdb_connector.py

```diff
@@ -3,31 +3,74 @@
 
 import duckdb
 import logging
 from contextlib import nullcontext
 from typing import Dict, Optional
 
 from pandas import DataFrame
+from pandas import ArrowDtype
+from pyarrow import Table
 
 from iql.iqmoql import IqlDatabaseConnector, IqlDatabase, IqlResult
 import threading
 
 from dataclasses import dataclass
 
 logger = logging.getLogger(__name__)
 
 
+def rename_dupe_arrow_columns(pat: Table) -> Table:
+    # PyArrow can't export to Pandas if there are duplicate columns
+    cols = pat.column_names
+    unique_cols = set(cols)
+
+    if len(unique_cols) == len(cols):
+        # everything is unique
+        return pat
+    else:
+        newcols = []
+        print(f"Has dupes, {cols}")
+        seen = set()
+        for col in cols:
+            if col not in seen:
+                seen.add(col)
+                newcols.append(col)
+            else:
+                idx = 1
+                while (newcol := f"{col}_{idx}") in seen or newcol in unique_cols:
+                    idx += 1
+                newcols.append(newcol)
+
+        pat = pat.rename_columns(newcols)
+
+        return pat
+
+
+@dataclass
+class DuckDbResult(IqlResult):
+    _table: Table
+
+    def arrow(self):
+        return self._table
+
+    def df_numpy(self):
+        return self._table.to_pandas()
+
+    def df_arrow(self):
+        return self._table.to_pandas(types_mapper=ArrowDtype)
+
+
 @dataclass
 class _DuckDB(IqlDatabase):
     _connection: object
     _started_thread: int
 
     def execute_query(
         self, query: str, completed_dfs: Optional[Dict[str, DataFrame]] = None
-    ) -> Optional[IqlResult]:
+    ) -> Optional[DuckDbResult]:
         """param: Each of the completed _dfs are registered to the database.
         threaded: pass True to run in a separate connection, otherwise runs in main connection
         """
 
         threaded = threading.get_ident() != self._started_thread
 
         # create & close the connection if we're threading, otherwise create one
@@ -48,15 +91,15 @@
                 d = con.execute(query)  # type: ignore
                 # Don't use con.sql, as it adds a small but
                 # measurable overhead of creating a duckdb relation, that we don't need
                 if d is not None:
                     # logger.debug("Using Pandas format")
                     try:
                         table = d.arrow()
-                        return IqlResult(_table=table)
+                        return DuckDbResult(_table=table)
                     except Exception:
                         # TODO: Detect this more gracefully
                         logger.debug("Didn't have a result set {str(e)}")
                         return None
 
                 else:
                     return None
```

## Comparing `iql-0.1.9b5.dist-info/LICENSE` & `iql-0.1.9b6.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `iql-0.1.9b5.dist-info/METADATA` & `iql-0.1.9b6.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: iql
-Version: 0.1.9b5
+Version: 0.1.9b6
 Summary: SQL Overlay Language with support for Bloomberg BQL, FRED, Edgar, Kaggle and other financial data sources within SQL
 Home-page: https://github.com/iqmo-org/iql_dev
 Author: Paul Timmins
 Author-email: paul@iqmo.com
 Keywords: IQMO Query Language IQMOQL BQL BQUANT FRED EDGAR KAGGLE
 Description-Content-Type: text/markdown
 License-File: LICENSE
```

## Comparing `iql-0.1.9b5.dist-info/RECORD` & `iql-0.1.9b6.dist-info/RECORD`

 * *Files 16% similar despite different names*

```diff
@@ -1,25 +1,25 @@
-iql/__init__.py,sha256=kct_rWhbxxCnWNvjDbqi0wNjAdObzk-18Hha97pTXrI,334
-iql/_version.py,sha256=_K8BRjNZIARMU64uK80yz8kORD28bob2tZbbnUPohmc,103
-iql/iqmoql.py,sha256=3XoqSnvjLKuzVJ8CRTSxkK7o1k-0CzmyeFM8sPRX2NM,34700
+iql/__init__.py,sha256=DfBkCF58y3GNp_W2-W6Vs2l2ov1thvCn_MEEc5SouQ4,372
+iql/_version.py,sha256=CYn4tZNXprIlcT2YBFYBuj8QjMywBXvKOrzXhHXdOAY,103
+iql/iqmoql.py,sha256=KRNQ1GFgNaBFF5K6j0jq5ZG8idtDWerpMdLBNWoj5SI,33829
 iql/options_parser.py,sha256=Sk6iRFCDrAbOZf0yYbUNLVKR5YvvMK8dJLNFPKy0xRc,1282
 iql/q_cache.py,sha256=H3uggWqv3YEC3UdzhT2N-44oY_Ne2kEN6_oJE8QUOxs,3233
 iql/threading_experimental.py,sha256=bKsGee-Y05Rr5z1Pf1P7gBqMHUzc86l5Tbe2CXn25Hc,2191
 iql/bbg_bql/__init__.py,sha256=nCTs4I9SAb24B7wg2Zd0wGsVLwamTu4BpFIIpRK0cDw,77
 iql/bbg_bql/bql_datamodel.py,sha256=1YPVfJVQE3vfaRMtAcKCxUNrrzQTeCm7D7bntIX35xw,10069
 iql/bbg_bql/bql_extension.py,sha256=0SzGZXaiQlTTTLWRxuo1hLIaKBLNWzfkx2VYV05Dk5o,8975
 iql/bbg_bql/bql_wrapper.py,sha256=nW72hMSCIY1hnW_eMTDNw83VQ2YYB3u4tCC7w7atAaw,13694
 iql/bbg_bql/debug_tools.py,sha256=Rfs-HivxSYgGyTrByhPwiZ6QKtCn2iUnuNNmcKf1BtQ,692
 iql/db_connectors/__init__.py,sha256=nCTs4I9SAb24B7wg2Zd0wGsVLwamTu4BpFIIpRK0cDw,77
-iql/db_connectors/duckdb_connector.py,sha256=PFEgSt-IRTLeapB3zzOoAltSyMTsA6aMo-7ygLDE_GA,3253
+iql/db_connectors/duckdb_connector.py,sha256=OmkufYvvg8T-BeWXATBoV3iZWcd9NyuhDGlPHgy_kjs,4311
 iql/extensions/__init__.py,sha256=nCTs4I9SAb24B7wg2Zd0wGsVLwamTu4BpFIIpRK0cDw,77
 iql/extensions/aws_s3_extension.py,sha256=rCyE9Xoo4eH3pnwxO0g4RgQTQHkNAxVKKmeidFs22XE,3470
 iql/extensions/edgar_extension.py,sha256=DQEsLSMY0J5gw3bLigbRJ7emMUiNEPhbPSCGJDo0Zi0,7829
 iql/extensions/fred_extension.py,sha256=YZbAMy3o8fzZ01ulvO2j5rhEQRsE9BrH96WP9NyrWX0,4279
 iql/extensions/kaggle_extension.py,sha256=h1dSdWiUF-h_J7aZjwqU3Pn2s5kw_XiKcQUT0ElmPVE,4106
 iql/extensions/pandas_extension.py,sha256=ue3izSZOTtbRR9g3_QkjPhWep_Or97aP-r4GP5HxLsw,2315
 iql/extensions/template_extension.py,sha256=jvF1r-ShKTM0o69wIw9aU448pe4S_lqw5Q86rusnybY,666
-iql-0.1.9b5.dist-info/LICENSE,sha256=fRoQlSrnKvIqTnrbUywcGohiS97ofE1quZqsib7WE0c,535
-iql-0.1.9b5.dist-info/METADATA,sha256=d9QHEfZ7A5LSgupqJ7wQloGSZBO2t1xI6YLdDn_02po,27298
-iql-0.1.9b5.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-iql-0.1.9b5.dist-info/top_level.txt,sha256=Tk45SvyMJ3Qip3gIAemqP9BvRhIokV7hGo3MyTS8Q0c,4
-iql-0.1.9b5.dist-info/RECORD,,
+iql-0.1.9b6.dist-info/LICENSE,sha256=fRoQlSrnKvIqTnrbUywcGohiS97ofE1quZqsib7WE0c,535
+iql-0.1.9b6.dist-info/METADATA,sha256=7t4l09p8nqmUxUbZcsNj8t46WEZXbXuenr7UcY4iOGM,27298
+iql-0.1.9b6.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+iql-0.1.9b6.dist-info/top_level.txt,sha256=Tk45SvyMJ3Qip3gIAemqP9BvRhIokV7hGo3MyTS8Q0c,4
+iql-0.1.9b6.dist-info/RECORD,,
```

